<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VittaWay — Planejador de Dieta</title>

  <!-- Fonte: opcional -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --green-dark: #163c2b;
      --green: #2e7d32;
      --green-light: #60ad5e;
      --muted: #6b6b6b;
      --surface: #ffffff;
      --bg: #f4fbf6;
      --danger: #c62828;
      --radius: 12px;
      --shadow: 0 6px 20px rgba(16, 94, 48, 0.08);
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      background:linear-gradient(180deg,#f7fffb 0%, var(--bg) 100%);
      color:#0f1720;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:32px;
    }

    .wrap{
      max-width:1000px;
      margin:0 auto;
      display:grid;
      grid-template-columns: 1fr 420px;
      gap:28px;
      align-items:start;
    }

    /* Card principal (form) */
    .card {
      background:var(--surface);
      border-radius:var(--radius);
      padding:28px;
      box-shadow:var(--shadow);
      border: 1px solid rgba(13,53,29,0.04);
    }

    header.appHeader{
      display:flex;
      align-items:center;
      gap:16px;
      margin-bottom:6px;
    }
    .logo {
      width:56px;height:56px;
      border-radius:10px;
      background:linear-gradient(135deg,var(--green),var(--green-light));
      display:flex;align-items:center;justify-content:center;
      color:white;font-weight:700;font-size:18px;
      box-shadow: 0 6px 18px rgba(46,125,50,0.12);
    }
    .title {
      font-size:20px;font-weight:700;color:var(--green-dark);
      line-height:1;
    }
    .subtitle {
      font-size:13px;color:var(--muted);margin-top:6px;
    }

    .help {
      font-size:13px;color:var(--muted);margin-top:12px;padding:12px;border-radius:10px;background:#f0fff4;border:1px solid rgba(46,125,50,0.06)
    }

    form .row { display:flex; gap:12px; }
    form .col { flex:1; min-width:0; }

    label{
      display:block;font-size:13px;color:var(--green-dark);margin-bottom:6px;font-weight:600;
    }
    input[type="text"], input[type="number"], input[type="email"], input[type="time"], select, textarea {
      width:100%;padding:10px 12px;border-radius:8px;border:1px solid #e6efe8;background: #fbfff9;
      font-size:14px;color:#073218;
    }
    textarea{min-height:86px;resize:vertical}

    .input-inline{display:flex;gap:8px;align-items:center}
    .radio-group, .checkbox-group { display:flex;flex-wrap:wrap;gap:10px; }
    .radio-option, .checkbox-option { background:#fff;padding:6px 8px;border-radius:8px;border:1px solid #eef6ee; display:flex;align-items:center; gap:8px; font-size:13px; }

    .small { font-size:13px;color:var(--muted); margin-top:6px; }
    .required { color: var(--danger); margin-left:4px; font-weight:700; }

    .actions { display:flex; gap:12px; align-items:center; justify-content:flex-end; margin-top:18px; }
    .btn {
      background:var(--green); color:#fff; padding:12px 16px; border-radius:10px; border:0; font-weight:700; cursor:pointer;
      box-shadow: 0 8px 20px rgba(46,125,50,0.12);
    }
    .btn:hover { background:var(--green-dark) }
    .btn[disabled]{ opacity:0.6; cursor:not-allowed }

    .secondary { background:transparent; border:1px solid rgba(0,0,0,0.06); color:var(--green-dark); padding:10px 14px; border-radius:10px; }

    .meta { font-size:13px;color:var(--muted); margin-top:12px }

    /* Right column (summary / instructions) */
    .aside { background: linear-gradient(180deg,#fff,#f9fff7); border-radius:12px; padding:20px; box-shadow: var(--shadow) }
    .aside h3{ margin:0 0 8px 0; color:var(--green-dark); font-size:16px }
    .aside p{ font-size:13px; color:var(--muted); margin:0 0 12px 0 }

    /* Toast */
    .toast {
      position:fixed;right:20px;bottom:20px;background:var(--green);color:#fff;padding:12px 18px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.12);
      transform:translateY(10px);opacity:0;transition:all .28s ease;pointer-events:none;
    }
    .toast.show { opacity:1; transform:translateY(0); pointer-events:auto; }

    /* Responsive */
    @media (max-width:980px) {
      .wrap { grid-template-columns: 1fr; padding:16px; }
    }
  </style>
</head>
<body>
  <main class="wrap">
    <!-- left: formulário -->
    <section class="card" aria-labelledby="formTitle">
      <header class="appHeader" role="banner">
        <div class="logo" aria-hidden="true">VW</div>
        <div>
          <div class="title" id="formTitle">VittaWay — Planejador de Dieta</div>
          <div class="subtitle">Preencha com dados reais. Receba um plano estimado e metas práticas.</div>
        </div>
      </header>

      <div class="help" id="helpBox">
        Preenchimento rápido — você pode usar fita métrica para as circunferências. Os resultados são estimativos e não substituem acompanhamento profissional.
      </div>

      <form id="dietForm" novalidate>
        <!-- Dados Pessoais -->
        <div style="margin-top:18px">
          <label for="nome">Nome completo <span class="required">*</span></label>
          <input id="nome" name="nome" type="text" autocomplete="name" required placeholder="Seu nome completo">
        </div>

        <div class="row" style="margin-top:12px">
          <div class="col">
            <label for="idade">Idade <span class="required">*</span></label>
            <input id="idade" name="idade" type="number" min="12" max="120" required placeholder="Ex: 29">
          </div>
          <div class="col">
            <label for="sexo">Sexo biológico <span class="required">*</span></label>
            <div class="radio-group" id="sexo">
              <label class="radio-option"><input type="radio" name="sexo" value="masculino" required> Masculino</label>
              <label class="radio-option"><input type="radio" name="sexo" value="feminino"> Feminino</label>
              <label class="radio-option"><input type="radio" name="sexo" value="outro"> Outro</label>
            </div>
          </div>
        </div>

        <!-- Medidas -->
        <fieldset style="margin-top:14px;border:0;padding:0">
          <legend class="small" style="font-weight:700;margin-bottom:8px;color:var(--green-dark)">Medidas (use fita métrica)</legend>

          <div class="row">
            <div class="col">
              <label for="altura">Altura (cm) <span class="required">*</span></label>
              <input id="altura" name="altura" type="number" min="100" max="250" step="0.1" required placeholder="Ex: 175">
            </div>
            <div class="col">
              <label for="peso">Peso (kg) <span class="required">*</span></label>
              <input id="peso" name="peso" type="number" min="30" max="300" step="0.1" required placeholder="Ex: 78.5">
            </div>
          </div>

          <div class="row" style="margin-top:8px">
            <div class="col">
              <label for="cintura">Cintura (cm) <span class="required">*</span></label>
              <input id="cintura" name="cintura" type="number" min="50" max="200" required>
            </div>
            <div class="col">
              <label for="quadril">Quadril (cm) <span class="required">*</span></label>
              <input id="quadril" name="quadril" type="number" min="60" max="200" required>
            </div>
          </div>

          <div class="row" style="margin-top:8px">
            <div class="col">
              <label for="busto">Busto/Peito (cm)</label>
              <input id="busto" name="busto" type="number" min="60" max="200">
            </div>
            <div class="col">
              <label for="braco">Braço (cm)</label>
              <input id="braco" name="braco" type="number" min="15" max="80">
            </div>
          </div>

          <div style="margin-top:8px">
            <label for="coxa">Coxa (cm)</label>
            <input id="coxa" name="coxa" type="number" min="30" max="120">
          </div>
        </fieldset>

        <!-- Objetivos -->
        <fieldset style="margin-top:14px;border:0;padding:0">
          <legend class="small" style="font-weight:700;margin-bottom:8px;color:var(--green-dark)">Objetivo e Metas</legend>

          <label>Principal objetivo <span class="required">*</span></label>
          <div class="radio-group">
            <label class="radio-option"><input type="radio" name="objetivo" value="emagrecer" required> Emagrecer</label>
            <label class="radio-option"><input type="radio" name="objetivo" value="ganhar-massa"> Ganhar massa</label>
            <label class="radio-option"><input type="radio" name="objetivo" value="manter-peso"> Manter peso</label>
            <label class="radio-option"><input type="radio" name="objetivo" value="melhorar-saude"> Melhorar saúde</label>
          </div>

          <div class="row" style="margin-top:8px">
            <div class="col">
              <label for="tempoObjetivo">Prazo desejado (meses) <span class="required">*</span></label>
              <input id="tempoObjetivo" name="tempoObjetivo" type="number" min="1" max="60" required>
            </div>
            <div class="col">
              <label>Prioridade <span class="required">*</span></label>
              <div class="radio-group">
                <label class="radio-option"><input type="radio" name="prioridade" value="rapido" required> Resultados rápidos</label>
                <label class="radio-option"><input type="radio" name="prioridade" value="sustentavel"> Sustentável</label>
                <label class="radio-option"><input type="radio" name="prioridade" value="equilibrio"> Equilíbrio</label>
              </div>
            </div>
          </div>

          <div style="margin-top:8px">
            <label>Já seguiu dieta antes?</label>
            <div class="radio-group">
              <label class="radio-option"><input type="radio" name="jaSeguiuDieta" value="sim"> Sim</label>
              <label class="radio-option"><input type="radio" name="jaSeguiuDieta" value="nao"> Não</label>
            </div>
            <div id="dietaAnteriorGroup" style="display:none;margin-top:8px">
              <label for="dietaAnteriorExperiencia">O que funcionou / não funcionou</label>
              <textarea id="dietaAnteriorExperiencia" name="dietaAnteriorExperiencia"></textarea>
            </div>
          </div>
        </fieldset>

        <!-- Saúde e restrições -->
        <fieldset style="margin-top:14px;border:0;padding:0">
          <legend class="small" style="font-weight:700;margin-bottom:8px;color:var(--green-dark)">Saúde e restrições</legend>

          <div class="row">
            <div class="col">
              <label for="alergias">Alergias / Intolerâncias</label>
              <input id="alergias" name="alergias" type="text" placeholder="Ex: lactose, amendoim">
            </div>
            <div class="col">
              <label for="restricoes">Restrições religiosas / estilo</label>
              <input id="restricoes" name="restricoes" type="text" placeholder="Ex: vegano">
            </div>
          </div>

          <div style="margin-top:8px">
            <label for="preferenciasAlimentares">Preferências (proteína/carbo)</label>
            <textarea id="preferenciasAlimentares" name="preferenciasAlimentares" placeholder="Ex: frango, peixe, arroz"></textarea>
          </div>

          <div style="margin-top:8px">
            <label>Problemas de saúde (marque os que se aplicam)</label>
            <div class="checkbox-group">
              <label class="checkbox-option"><input type="checkbox" name="problemasSaude" value="diabetes"> Diabetes</label>
              <label class="checkbox-option"><input type="checkbox" name="problemasSaude" value="hipertensao"> Hipertensão</label>
              <label class="checkbox-option"><input type="checkbox" name="problemasSaude" value="colesterol"> Colesterol</label>
              <label class="checkbox-option"><input type="checkbox" name="problemasSaude" value="tireoide"> Tireoide</label>
              <label class="checkbox-option"><input type="checkbox" name="problemasSaude" value="gastrico"> Gastro</label>
              <label class="checkbox-option"><input type="checkbox" name="problemasSaude" value="outro"> Outro</label>
            </div>
          </div>

          <div style="margin-top:8px">
            <label for="medicamentos">Medicamentos (nome e dosagem)</label>
            <textarea id="medicamentos" name="medicamentos" placeholder="Liste se fizer uso"></textarea>
          </div>

          <div style="margin-top:8px">
            <label>Nível de estresse (0 a 5) <span class="required">*</span></label>
            <input id="estresse" name="estresse" type="range" min="0" max="5" step="1" value="2">
            <div class="small">0 (nenhum) — 5 (muito)</div>
          </div>
        </fieldset>

        <!-- Hábitos alimentares -->
        <fieldset style="margin-top:14px;border:0;padding:0">
          <legend class="small" style="font-weight:700;margin-bottom:8px;color:var(--green-dark)">Hábitos alimentares</legend>

          <div class="row">
            <div class="col">
              <label for="refeicoes">Refeições principais/dia <span class="required">*</span></label>
              <select id="refeicoes" name="refeicoes" required>
                <option value="">Selecione</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4+">4 ou mais</option>
              </select>
            </div>
            <div class="col">
              <label>Faz lanches?</label>
              <div class="radio-group">
                <label class="radio-option"><input type="radio" name="lanches" value="nunca"> Nunca</label>
                <label class="radio-option"><input type="radio" name="lanches" value="as-vezes"> Às vezes</label>
                <label class="radio-option"><input type="radio" name="lanches" value="sempre"> Sempre</label>
              </div>
            </div>
          </div>

          <div class="row" style="margin-top:8px">
            <div class="col">
              <label for="acordar">Horário que acorda</label>
              <input id="acordar" name="acordar" type="time">
            </div>
            <div class="col">
              <label for="dormir">Horário que dorme</label>
              <input id="dormir" name="dormir" type="time">
            </div>
          </div>

          <div style="margin-top:8px">
            <label for="gostaComer">O que mais gosta de comer <span class="required">*</span></label>
            <textarea id="gostaComer" name="gostaComer" required placeholder="Ex: massas, carnes, saladas..."></textarea>
          </div>

          <div style="margin-top:8px">
            <label for="naoGosta">O que não gosta</label>
            <textarea id="naoGosta" name="naoGosta" placeholder="Ex: brócolis, peixe..."></textarea>
          </div>

          <div class="row" style="margin-top:8px">
            <div class="col">
              <label>Doces / frituras / refrigerantes?</label>
              <div class="radio-group">
                <label class="radio-option"><input type="radio" name="doces" value="nunca"> Nunca</label>
                <label class="radio-option"><input type="radio" name="doces" value="pouco"> Pouco</label>
                <label class="radio-option"><input type="radio" name="doces" value="frequentemente"> Frequentemente</label>
              </div>
            </div>
            <div class="col">
              <label>Consumo de álcool</label>
              <div class="radio-group">
                <label class="radio-option"><input type="radio" name="alcool" value="nunca"> Nunca</label>
                <label class="radio-option"><input type="radio" name="alcool" value="socialmente"> Socialmente</label>
                <label class="radio-option"><input type="radio" name="alcool" value="frequentemente"> Frequentemente</label>
              </div>
            </div>
          </div>

          <div style="margin-top:8px">
            <label>Costuma beber água?</label>
            <div class="radio-group">
              <label class="radio-option"><input type="radio" name="agua" value="sim"> Sim</label>
              <label class="radio-option"><input type="radio" name="agua" value="nao"> Não</label>
            </div>
          </div>

          <div class="row" style="margin-top:8px">
            <div class="col">
              <label for="localRefeicoes">Onde faz a maioria das refeições?</label>
              <select id="localRefeicoes" name="localRefeicoes">
                <option value="">Selecione</option>
                <option value="casa">Em casa</option>
                <option value="trabalho">No trabalho</option>
                <option value="restaurante">Restaurante</option>
                <option value="variados">Variados</option>
              </select>
            </div>
            <div class="col">
              <label for="preparoRef">Quem prepara suas refeições?</label>
              <select id="preparoRef" name="preparoRef">
                <option value="">Selecione</option>
                <option value="eu">Eu mesmo(a)</option>
                <option value="familia">Família</option>
                <option value="cozinheira">Cozinheira</option>
                <option value="restaurante">Restaurante</option>
              </select>
            </div>
          </div>
        </fieldset>

        <!-- Atividade física -->
        <fieldset style="margin-top:14px;border:0;padding:0">
          <legend class="small" style="font-weight:700;margin-bottom:8px;color:var(--green-dark)">Atividade física</legend>

          <label>Pratica atividade física?</label>
          <div class="radio-group">
            <label class="radio-option"><input type="radio" name="exercicio" value="sim"> Sim</label>
            <label class="radio-option"><input type="radio" name="exercicio" value="nao"> Não</label>
          </div>

          <div id="tipoExercicioGroup" style="display:none;margin-top:8px">
            <label for="tipoExercicio">Se sim, qual e com que frequência?</label>
            <textarea id="tipoExercicio" name="tipoExercicio"></textarea>
          </div>

          <div style="margin-top:8px">
            <label>Nível de atividade diária</label>
            <div class="radio-group">
              <label class="radio-option"><input type="radio" name="atividade" value="sedentario"> Sedentário</label>
              <label class="radio-option"><input type="radio" name="atividade" value="leve"> Leve</label>
              <label class="radio-option"><input type="radio" name="atividade" value="moderado"> Moderado</label>
              <label class="radio-option"><input type="radio" name="atividade" value="intenso"> Intenso</label>
            </div>
          </div>
        </fieldset>

        <!-- Preferências -->
        <fieldset style="margin-top:14px;border:0;padding:0">
          <legend class="small" style="font-weight:700;margin-bottom:8px;color:var(--green-dark)">Preferências da dieta</legend>

          <div class="checkbox-group">
            <label class="checkbox-option"><input type="checkbox" name="preferencias" value="tempo"> Pouco tempo de preparo</label>
            <label class="checkbox-option"><input type="checkbox" name="preferencias" value="barato"> Ingredientes baratos</label>
            <label class="checkbox-option"><input type="checkbox" name="preferencias" value="variado"> Refeições variadas</label>
            <label class="checkbox-option"><input type="checkbox" name="preferencias" value="facil"> Fácil fora de casa</label>
          </div>

          <div style="margin-top:8px">
            <label>Tipo de dieta preferida</label>
            <div class="radio-group">
              <label class="radio-option"><input type="radio" name="tipoDieta" value="adaptada"> Adaptada</label>
              <label class="radio-option"><input type="radio" name="tipoDieta" value="radical"> Radical</label>
            </div>
          </div>

          <div style="margin-top:8px">
            <label>Cardápio</label>
            <div class="radio-group">
              <label class="radio-option"><input type="radio" name="cardapio" value="fixo"> Fixo</label>
              <label class="radio-option"><input type="radio" name="cardapio" value="variado"> Variado</label>
            </div>
          </div>

          <div style="margin-top:8px">
            <label>Maior desafio</label>
            <div class="checkbox-group">
              <label class="checkbox-option"><input type="checkbox" name="desafios" value="tempo"> Falta de tempo</label>
              <label class="checkbox-option"><input type="checkbox" name="desafios" value="vontade"> Vontade por doces</label>
              <label class="checkbox-option"><input type="checkbox" name="desafios" value="disciplina"> Falta de disciplina</label>
              <label class="checkbox-option"><input type="checkbox" name="desafios" value="conhecimento"> Falta de conhecimento</label>
              <label class="checkbox-option"><input type="checkbox" name="desafios" value="financeiro"> Limitação financeira</label>
            </div>
          </div>
        </fieldset>

        <!-- Email e envio -->
        <div style="margin-top:14px">
          <label for="email">E-mail para receber o relatório <span class="required">*</span></label>
          <input id="email" name="email" type="email" required placeholder="seu@exemplo.com">
          <div class="meta">Lembre-se: só enviamos relatório para e-mails autorizados (controle no backend).</div>
        </div>

        <div class="actions" style="margin-top:18px">
          <button type="button" class="secondary" id="resetBtn">Limpar</button>
          <button type="submit" class="btn" id="submitBtn">Enviar e gerar plano</button>
        </div>

        <div class="meta" style="margin-top:12px">
          Ao enviar você concorda com a política de privacidade (dados usados apenas para gerar o plano). Não substitui consulta profissional.
        </div>
      </form>
    </section>

    <!-- right: instruções / resumo -->
    <aside class="aside">
      <h3>Pronto para testar</h3>
      <p>Insira os dados e clique em <strong>Enviar e gerar plano</strong>. O sistema envia os dados para um Apps Script (substitua o link no código).</p>
      <h3 style="margin-top:14px">Observações técnicas</h3>
      <ul style="font-size:13px;color:var(--muted);padding-left:18px;">
        <li>Substitua <code>APP_SCRIPT_URL</code> pelo seu link /exec do Apps Script.</li>
        <li>Se houver erro CORS no navegador, verifique deploy do Apps Script: "Executar como: Você" / "Quem tem acesso: Qualquer pessoa (anônima)".</li>
        <li>Para teste rápido use <code>curl</code> ou Postman: envie JSON com as mesmas chaves (camelCase).</li>
      </ul>
    </aside>
  </main>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    // === CONFIG: cole seu URL do Apps Script aqui (use /exec, não /dev) ===
    const APP_SCRIPT_URL = 'COLE_AQUI_SEU_APP_SCRIPT_URL_EXEC';
    // ====================================================================

    // Helpers
    const $ = (sel, ctx=document) => ctx.querySelector(sel);
    const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));
    const toast = (msg, ok=true) => {
      const el = $('#toast');
      el.textContent = msg;
      el.style.background = ok ? 'var(--green)' : 'var(--danger)';
      el.classList.add('show');
      setTimeout(()=>el.classList.remove('show'), 3800);
    };

    const form = $('#dietForm');
    const submitBtn = $('#submitBtn');
    const resetBtn = $('#resetBtn');

    // Conditional UI
    $$('input[name="jaSeguiuDieta"]').forEach(r => {
      r.addEventListener('change', ()=> {
        $('#dietaAnteriorGroup').style.display = r.value === 'sim' && r.checked ? 'block' : 'none';
      });
    });
    $$('input[name="exercicio"]').forEach(r => {
      r.addEventListener('change', ()=> {
        $('#tipoExercicioGroup').style.display = r.value === 'sim' && r.checked ? 'block' : 'none';
      });
    });

    // Serialize form to object (handles checkboxes -> arrays)
    function serializeFormToObject(formEl){
      const fd = new FormData(formEl);
      const obj = {};
      for (const [key, value] of fd.entries()) {
        // If key already exists, convert to array
        if (obj.hasOwnProperty(key)) {
          if (!Array.isArray(obj[key])) obj[key] = [obj[key]];
          obj[key].push(value);
        } else {
          obj[key] = value;
        }
      }
      // normalize empty strings to undefined (optional)
      return obj;
    }

    // Front-end validation helper (basic)
    function validate(formEl) {
      // use native validity + required attributes
      if (!formEl.reportValidity()) return false;
      // custom: ensure at least one objetivo selected
      const objetivo = formEl.querySelector('input[name="objetivo"]:checked');
      if (!objetivo) { toast('Selecione um objetivo.', false); return false; }
      return true;
    }

    // Submit handler
    form.addEventListener('submit', async (ev) => {
      ev.preventDefault();
      if (!validate(form)) return;

      submitBtn.disabled = true;
      submitBtn.textContent = 'Enviando...';

      const payload = serializeFormToObject(form);
      payload.timestamp = new Date().toISOString();

      // Try normal fetch first
      try {
        const res = await fetch(APP_SCRIPT_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        // If response is opaque or not ok, try fallback
        if (!res.ok) {
          // If status exists but not ok => error
          let text = await res.text().catch(()=>null);
          toast('Erro no envio: ' + (text || res.status), false);
          console.error('Server error response:', res, text);
        } else {
          // try parse JSON (Apps Script returns JSON)
          const json = await res.json().catch(()=>null);
          if (json && json.status === 'success') {
            toast('Formulário enviado com sucesso!');
            form.reset();
          } else {
            toast('Enviado — verifique planilha. (resposta inesperada)', true);
            form.reset();
          }
        }
      } catch (err) {
        // CORS or network error: tentar fallback com no-cors
        console.warn('Fetch normal falhou:', err);
        try {
          await fetch(APP_SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
          });
          // Não é possível ler resposta em no-cors; presumimos sucesso se não lançou
          toast('Enviado (fallback). Se não aparecer na planilha, verifique deploy do Apps Script.', true);
          form.reset();
        } catch (err2) {
          console.error('Fallback também falhou:', err2);
          toast('Falha ao enviar — veja console e verifique URL/permissões.', false);
        }
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Enviar e gerar plano';
      }
    });

    resetBtn.addEventListener('click', ()=> {
      form.reset();
      toast('Formulário limpo.', true);
    });

    // Accessibility: focus first input on load
    window.addEventListener('load', ()=>{ $('#nome').focus(); });

    // Small: update slider label (if you want to display numeric)
    const estresse = $('#estresse');
    if(estresse){
      estresse.addEventListener('input', ()=> {
        // optional: show current value somewhere
      });
    }
  </script>
</body>
</html>
